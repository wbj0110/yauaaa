#
# Yet Another UserAgent Analyzer
# Copyright (C) 2013-2019 Niels Basjes
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
# https://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an AS IS BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

config:

- matcher:
    variable:
    - 'Google:agent.product.comments.entry.product.name[1]="Googlebot"'
    require:
    - 'agent.product.comments.entry.url="http://www.google.com/bot.html"'
    - 'IsNull[agent.product.comments.entry.url!="http://www.google.com/bot.html"]'
    extract:
    - '__Set_ALL_Fields__                  :   2999 :"<<<null>>>"' # Must be 1 lower than the rest (or you will wipe yourself too)
    - 'DeviceClass                         :   3000 :"Robot"'
    - 'DeviceBrand                         :   3000 :"Google"'
    - 'DeviceName                          :   3000 :"Google"'
    - 'OperatingSystemClass                :   3000 :"Cloud"'
    - 'OperatingSystemName                 :   3000 :"Google"'
    - 'OperatingSystemVersion              :   3000 :"Google"'
    - 'LayoutEngineClass                   :   3000 :"Robot"'
    - 'LayoutEngineName                    :   3000 :"Googlebot"'
    - 'LayoutEngineVersion                 :   3000 :"Googlebot"'
    - 'AgentClass                          :   3000 :"Robot"'
    - 'AgentName                           :   3000 :@Google@'
    - 'AgentVersion                        :   3000 :@Google^.version'

- matcher:
    variable:
    - 'Google:agent.(1)product.name[1]="Googlebot"'
    extract:
    - '__Set_ALL_Fields__                  :   3009 :"<<<null>>>"' # Must be 1 lower than the rest (or you will wipe yourself too)
    - 'DeviceClass                         :   3010 :"Robot"'
    - 'DeviceBrand                         :   3010 :"Google"'
    - 'DeviceName                          :   3010 :"Google"'
    - 'OperatingSystemClass                :   3010 :"Cloud"'
    - 'OperatingSystemName                 :   3010 :"Google"'
    - 'OperatingSystemVersion              :   3010 :"Google"'
    - 'LayoutEngineClass                   :   3010 :"Robot"'
    - 'LayoutEngineName                    :   3010 :"Googlebot"'
    - 'LayoutEngineVersion                 :   3010 :"Googlebot"'
    - 'AgentClass                          :   3010 :"Robot"'
    - 'AgentName                           :   3010 :@Google@'
    - 'AgentVersion                        :   3010 :@Google^.version'

# ------------------------------------------------------------

- matcher:
    require:
    - 'agent.(1)product.(1)name="AdsBot-Google"'
    extract:
    - '__Set_ALL_Fields__                  :   3019 :"<<<null>>>"' # Must be 1 lower than the rest (or you will wipe yourself too)
    - 'DeviceClass                         :   3020 :"Robot"'
    - 'DeviceBrand                         :   3020 :"Google"'
    - 'DeviceName                          :   3020 :"Google"'
    - 'OperatingSystemClass                :   3020 :"Cloud"'
    - 'OperatingSystemName                 :   3020 :"Google"'
    - 'OperatingSystemVersion              :   3020 :"Google"'
    - 'LayoutEngineClass                   :   3020 :"Robot"'
    - 'LayoutEngineName                    :   3020 :"Googlebot"'
    - 'LayoutEngineVersion                 :   3020 :"Googlebot"'
    - 'AgentClass                          :   3020 :"Robot"'
    - 'AgentName                           :   3020 :"Googlebot"'
    - 'AgentVersion                        :   3020 :"AdsBot-Google"'

- matcher:
    require:
    - 'agent.product.comments.entry.(1)text="AdsBot-Google"'
    extract:
    - '__Set_ALL_Fields__                  :   3019 :"<<<null>>>"' # Must be 1 lower than the rest (or you will wipe yourself too)
    - 'DeviceClass                         :   3020 :"Robot"'
    - 'DeviceBrand                         :   3020 :"Google"'
    - 'DeviceName                          :   3020 :"Google"'
    - 'OperatingSystemClass                :   3020 :"Cloud"'
    - 'OperatingSystemName                 :   3020 :"Google"'
    - 'OperatingSystemVersion              :   3020 :"Google"'
    - 'LayoutEngineClass                   :   3020 :"Robot"'
    - 'LayoutEngineName                    :   3020 :"Googlebot"'
    - 'LayoutEngineVersion                 :   3020 :"Googlebot"'
    - 'AgentClass                          :   3020 :"Robot"'
    - 'AgentName                           :   3020 :"Googlebot"'
    - 'AgentVersion                        :   3020 :"AdsBot-Google"'


- matcher:
    require:
    - 'agent.(1)product.(1)name="AdsBot-Google-Mobile"'
    extract:
    - '__Set_ALL_Fields__                  :   3019 :"<<<null>>>"' # Must be 1 lower than the rest (or you will wipe yourself too)
    - 'DeviceClass                         :   3020 :"Robot Mobile"'
    - 'DeviceBrand                         :   3020 :"Google"'
    - 'DeviceName                          :   3020 :"Google"'
    - 'OperatingSystemClass                :   3020 :"Cloud"'
    - 'OperatingSystemName                 :   3020 :"Google"'
    - 'OperatingSystemVersion              :   3020 :"Google"'
    - 'LayoutEngineClass                   :   3020 :"Robot"'
    - 'LayoutEngineName                    :   3020 :"Googlebot"'
    - 'LayoutEngineVersion                 :   3020 :"Googlebot"'
    - 'AgentClass                          :   3020 :"Robot"'
    - 'AgentName                           :   3020 :"Googlebot"'
    - 'AgentVersion                        :   3020 :"AdsBot-Google-Mobile"'

- matcher:
    require:
    - 'agent.product.comments.entry.(1)text="AdsBot-Google-Mobile"'
    extract:
    - '__Set_ALL_Fields__                  :   3019 :"<<<null>>>"' # Must be 1 lower than the rest (or you will wipe yourself too)
    - 'DeviceClass                         :   3020 :"Robot Mobile"'
    - 'DeviceBrand                         :   3020 :"Google"'
    - 'DeviceName                          :   3020 :"Google"'
    - 'OperatingSystemClass                :   3020 :"Cloud"'
    - 'OperatingSystemName                 :   3020 :"Google"'
    - 'OperatingSystemVersion              :   3020 :"Google"'
    - 'LayoutEngineClass                   :   3020 :"Robot"'
    - 'LayoutEngineName                    :   3020 :"Googlebot"'
    - 'LayoutEngineVersion                 :   3020 :"Googlebot"'
    - 'AgentClass                          :   3020 :"Robot"'
    - 'AgentName                           :   3020 :"Googlebot"'
    - 'AgentVersion                        :   3020 :"AdsBot-Google-Mobile"'


# https://support.google.com/webmasters/answer/1061943?hl=en

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (compatible; Googlebot/2.1; +http://www.google.com/bot.html)'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'Google'
      DeviceBrand                          : 'Google'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Google'
      OperatingSystemVersion               : 'Google'
      OperatingSystemNameVersion           : 'Google'
      LayoutEngineClass                    : 'Robot'
      LayoutEngineName                     : 'Googlebot'
      LayoutEngineVersion                  : 'Googlebot'
      LayoutEngineVersionMajor             : 'Googlebot'
      LayoutEngineNameVersion              : 'Googlebot'
      LayoutEngineNameVersionMajor         : 'Googlebot'
      AgentClass                           : 'Robot'
      AgentName                            : 'Googlebot'
      AgentVersion                         : '2.1'
      AgentVersionMajor                    : '2'
      AgentNameVersion                     : 'Googlebot 2.1'
      AgentNameVersionMajor                : 'Googlebot 2'
      AgentInformationUrl                  : 'http://www.google.com/bot.html'

# ------------------------------------------------------------
- test:
    input:
      user_agent_string: 'Googlebot/2.1 (+http://www.google.com/bot.html)'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'Google'
      DeviceBrand                          : 'Google'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Google'
      OperatingSystemVersion               : 'Google'
      OperatingSystemNameVersion           : 'Google'
      LayoutEngineClass                    : 'Robot'
      LayoutEngineName                     : 'Googlebot'
      LayoutEngineVersion                  : 'Googlebot'
      LayoutEngineVersionMajor             : 'Googlebot'
      LayoutEngineNameVersion              : 'Googlebot'
      LayoutEngineNameVersionMajor         : 'Googlebot'
      AgentClass                           : 'Robot'
      AgentName                            : 'Googlebot'
      AgentVersion                         : '2.1'
      AgentVersionMajor                    : '2'
      AgentNameVersion                     : 'Googlebot 2.1'
      AgentNameVersionMajor                : 'Googlebot 2'
      AgentInformationUrl                  : 'http://www.google.com/bot.html'

# ------------------------------------------------------------

- test:
    input:
      user_agent_string: 'Googlebot-Image/1.0'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'Google'
      DeviceBrand                          : 'Google'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Google'
      OperatingSystemVersion               : 'Google'
      OperatingSystemNameVersion           : 'Google'
      LayoutEngineClass                    : 'Robot'
      LayoutEngineName                     : 'Googlebot'
      LayoutEngineVersion                  : 'Googlebot'
      LayoutEngineVersionMajor             : 'Googlebot'
      LayoutEngineNameVersion              : 'Googlebot'
      LayoutEngineNameVersionMajor         : 'Googlebot'
      AgentClass                           : 'Robot'
      AgentName                            : 'Googlebot-Image'
      AgentVersion                         : '1.0'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'Googlebot-Image 1.0'
      AgentNameVersionMajor                : 'Googlebot-Image 1'

# ------------------------------------------------------------
- test:
    input:
      user_agent_string: 'Googlebot-Video/1.0'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'Google'
      DeviceBrand                          : 'Google'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Google'
      OperatingSystemVersion               : 'Google'
      OperatingSystemNameVersion           : 'Google'
      LayoutEngineClass                    : 'Robot'
      LayoutEngineName                     : 'Googlebot'
      LayoutEngineVersion                  : 'Googlebot'
      LayoutEngineVersionMajor             : 'Googlebot'
      LayoutEngineNameVersion              : 'Googlebot'
      LayoutEngineNameVersionMajor         : 'Googlebot'
      AgentClass                           : 'Robot'
      AgentName                            : 'Googlebot-Video'
      AgentVersion                         : '1.0'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'Googlebot-Video 1.0'
      AgentNameVersionMajor                : 'Googlebot-Video 1'

# ------------------------------------------------------------
#Googlebot-Mobile

# Mobile google bots

- matcher:
    require:
    - 'agent.product.comments.entry.(1)product.(1)name="Googlebot"'
    - 'agent.product.name="Mobile"'
    extract:
    - 'AgentClass                          :  10000 :"Robot Mobile"'
    - 'DeviceClass                         :  10000 :"Robot Mobile"'

- matcher:
    require:
    - 'agent.product.comments.entry.(1)product.(1)name="Googlebot"'
    - 'agent.product.name="Mobile Safari"'
    extract:
    - 'AgentClass                          :  10000 :"Robot Mobile"'
    - 'DeviceClass                         :  10000 :"Robot Mobile"'

- matcher:
    require:
    - 'agent.product.comments.entry.(1)product.(1)name="Googlebot-Mobile"'
    extract:
    - 'AgentClass                          :  10000 :"Robot Mobile"'
    - 'DeviceClass                         :  10000 :"Robot Mobile"'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPhone; CPU iPhone OS 6_0 like Mac OS X) AppleWebKit/536.26 (KHTML, like Gecko) Version/6.0 Mobile/10A5376e Safari/8536.25 (compatible; Googlebot/2.1; +http://www.google.com/bot.html)'
    expected:
      DeviceClass                          : 'Robot Mobile'
      DeviceName                           : 'Google'
      DeviceBrand                          : 'Google'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Google'
      OperatingSystemVersion               : 'Google'
      OperatingSystemNameVersion           : 'Google'
      LayoutEngineClass                    : 'Robot'
      LayoutEngineName                     : 'Googlebot'
      LayoutEngineVersion                  : 'Googlebot'
      LayoutEngineVersionMajor             : 'Googlebot'
      LayoutEngineNameVersion              : 'Googlebot'
      LayoutEngineNameVersionMajor         : 'Googlebot'
      AgentClass                           : 'Robot Mobile'
      AgentName                            : 'Googlebot'
      AgentVersion                         : '2.1'
      AgentVersionMajor                    : '2'
      AgentNameVersion                     : 'Googlebot 2.1'
      AgentNameVersionMajor                : 'Googlebot 2'
      AgentInformationUrl                  : 'http://www.google.com/bot.html'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android 4.0.4; Galaxy Nexus Build/IMM76B) AppleWebKit/535.19 (KHTML, like Gecko) Chrome/18.0.1025.133 Mobile Safari/535.19 (compatible; Googlebot/2.1; +http://www.google.com/bot.html)'
    expected:
      DeviceClass                          : 'Robot Mobile'
      DeviceName                           : 'Google'
      DeviceBrand                          : 'Google'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Google'
      OperatingSystemVersion               : 'Google'
      OperatingSystemNameVersion           : 'Google'
      LayoutEngineClass                    : 'Robot'
      LayoutEngineName                     : 'Googlebot'
      LayoutEngineVersion                  : 'Googlebot'
      LayoutEngineVersionMajor             : 'Googlebot'
      LayoutEngineNameVersion              : 'Googlebot'
      LayoutEngineNameVersionMajor         : 'Googlebot'
      AgentClass                           : 'Robot Mobile'
      AgentName                            : 'Googlebot'
      AgentVersion                         : '2.1'
      AgentVersionMajor                    : '2'
      AgentNameVersion                     : 'Googlebot 2.1'
      AgentNameVersionMajor                : 'Googlebot 2'
      AgentInformationUrl                  : 'http://www.google.com/bot.html'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 AppleWebKit/537.36 (KHTML, like Gecko; compatible; Googlebot/2.1; +http://www.google.com/bot.html) Safari/537.36'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'Google'
      DeviceBrand                          : 'Google'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Google'
      OperatingSystemVersion               : 'Google'
      OperatingSystemNameVersion           : 'Google'
      LayoutEngineClass                    : 'Robot'
      LayoutEngineName                     : 'Googlebot'
      LayoutEngineVersion                  : 'Googlebot'
      LayoutEngineVersionMajor             : 'Googlebot'
      LayoutEngineNameVersion              : 'Googlebot'
      LayoutEngineNameVersionMajor         : 'Googlebot'
      AgentClass                           : 'Robot'
      AgentName                            : 'Googlebot'
      AgentVersion                         : '2.1'
      AgentVersionMajor                    : '2'
      AgentNameVersion                     : 'Googlebot 2.1'
      AgentNameVersionMajor                : 'Googlebot 2'
      AgentInformationUrl                  : 'http://www.google.com/bot.html'

- test:
    input:
      user_agent_string: 'SAMSUNG-SGH-E250/1.0 Profile/MIDP-2.0 Configuration/CLDC-1.1 UP.Browser/6.2.3.3.c.1.101 (GUI) MMP/2.0 (compatible; Googlebot-Mobile/2.1; +http://www.google.com/bot.html)'
    expected:
      DeviceClass                          : 'Robot Mobile'
      DeviceName                           : 'Google'
      DeviceBrand                          : 'Google'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Google'
      OperatingSystemVersion               : 'Google'
      OperatingSystemNameVersion           : 'Google'
      LayoutEngineClass                    : 'Robot'
      LayoutEngineName                     : 'Googlebot'
      LayoutEngineVersion                  : 'Googlebot'
      LayoutEngineVersionMajor             : 'Googlebot'
      LayoutEngineNameVersion              : 'Googlebot'
      LayoutEngineNameVersionMajor         : 'Googlebot'
      AgentClass                           : 'Robot Mobile'
      AgentName                            : 'Googlebot-Mobile'
      AgentVersion                         : '2.1'
      AgentVersionMajor                    : '2'
      AgentNameVersion                     : 'Googlebot-Mobile 2.1'
      AgentNameVersionMajor                : 'Googlebot-Mobile 2'
      AgentInformationUrl                  : 'http://www.google.com/bot.html'

# ------------------------------------------------------------
- test:
    input:
      user_agent_string: 'DoCoMo/2.0 N905i(c100;TB;W24H16) (compatible; Googlebot-Mobile/2.1; +http://www.google.com/bot.html)'
    expected:
      DeviceClass                          : 'Robot Mobile'
      DeviceName                           : 'Google'
      DeviceBrand                          : 'Google'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Google'
      OperatingSystemVersion               : 'Google'
      OperatingSystemNameVersion           : 'Google'
      LayoutEngineClass                    : 'Robot'
      LayoutEngineName                     : 'Googlebot'
      LayoutEngineVersion                  : 'Googlebot'
      LayoutEngineVersionMajor             : 'Googlebot'
      LayoutEngineNameVersion              : 'Googlebot'
      LayoutEngineNameVersionMajor         : 'Googlebot'
      AgentClass                           : 'Robot Mobile'
      AgentName                            : 'Googlebot-Mobile'
      AgentVersion                         : '2.1'
      AgentVersionMajor                    : '2'
      AgentNameVersion                     : 'Googlebot-Mobile 2.1'
      AgentNameVersionMajor                : 'Googlebot-Mobile 2'
      AgentInformationUrl                  : 'http://www.google.com/bot.html'

# ------------------------------------------------------------
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPhone; CPU iPhone OS 8_3 like Mac OS X) AppleWebKit/600.1.4 (KHTML, like Gecko) Version/8.0 Mobile/12F70 Safari/600.1.4 (compatible; Googlebot/2.1; +http://www.google.com/bot.html)'
    expected:
      DeviceClass                          : 'Robot Mobile'
      DeviceName                           : 'Google'
      DeviceBrand                          : 'Google'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Google'
      OperatingSystemVersion               : 'Google'
      OperatingSystemNameVersion           : 'Google'
      LayoutEngineClass                    : 'Robot'
      LayoutEngineName                     : 'Googlebot'
      LayoutEngineVersion                  : 'Googlebot'
      LayoutEngineVersionMajor             : 'Googlebot'
      LayoutEngineNameVersion              : 'Googlebot'
      LayoutEngineNameVersionMajor         : 'Googlebot'
      AgentClass                           : 'Robot Mobile'
      AgentName                            : 'Googlebot'
      AgentVersion                         : '2.1'
      AgentVersionMajor                    : '2'
      AgentNameVersion                     : 'Googlebot 2.1'
      AgentNameVersionMajor                : 'Googlebot 2'
      AgentInformationUrl                  : 'http://www.google.com/bot.html'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android 6.0.1; Nexus 5X Build/MMB29P) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/41.0.2272.96 Mobile Safari/537.36 (compatible; Googlebot/2.1; +http://www.google.com/bot.html)'
    expected:
      DeviceClass                          : 'Robot Mobile'
      DeviceName                           : 'Google'
      DeviceBrand                          : 'Google'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Google'
      OperatingSystemVersion               : 'Google'
      OperatingSystemNameVersion           : 'Google'
      LayoutEngineClass                    : 'Robot'
      LayoutEngineName                     : 'Googlebot'
      LayoutEngineVersion                  : 'Googlebot'
      LayoutEngineVersionMajor             : 'Googlebot'
      LayoutEngineNameVersion              : 'Googlebot'
      LayoutEngineNameVersionMajor         : 'Googlebot'
      AgentClass                           : 'Robot Mobile'
      AgentName                            : 'Googlebot'
      AgentVersion                         : '2.1'
      AgentVersionMajor                    : '2'
      AgentNameVersion                     : 'Googlebot 2.1'
      AgentNameVersionMajor                : 'Googlebot 2'
      AgentInformationUrl                  : 'http://www.google.com/bot.html'

# ------------------------------------------------------------

#Google Mobile AdSense Mediapartners-Google
#
#of
#
#Mediapartners
#(Googlebot)    [verschillende soorten mobiele apparaten] (compatibel; Mediapartners-Google/2.1; +http://www.google.com/bot.html)
#Google AdSense    Mediapartners-Google
#Mediapartners
#(Googlebot)    Mediapartners-Google
#Kwaliteitscontrole voor Google AdsBot-bestemmingspagina    AdsBot-Google

- test:
    input:
      user_agent_string: 'AdsBot-Google (+http://www.google.com/adsbot.html)'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'Google'
      DeviceBrand                          : 'Google'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Google'
      OperatingSystemVersion               : 'Google'
      OperatingSystemNameVersion           : 'Google'
      LayoutEngineClass                    : 'Robot'
      LayoutEngineName                     : 'Googlebot'
      LayoutEngineVersion                  : 'Googlebot'
      LayoutEngineVersionMajor             : 'Googlebot'
      LayoutEngineNameVersion              : 'Googlebot'
      LayoutEngineNameVersionMajor         : 'Googlebot'
      AgentClass                           : 'Robot'
      AgentName                            : 'Googlebot'
      AgentVersion                         : 'AdsBot-Google'
      AgentVersionMajor                    : 'AdsBot'
      AgentNameVersion                     : 'Googlebot AdsBot-Google'
      AgentNameVersionMajor                : 'Googlebot AdsBot'
      AgentInformationUrl                  : 'http://www.google.com/adsbot.html'

# https://support.google.com/adwords/answer/2404197
# Quote:  Currently, we use two HTTP User-Agent header to identify AdWords mobile visits:

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android 5.0; SM-G920A) AppleWebKit (KHTML, like Gecko) Chrome Mobile Safari (compatible; AdsBot-Google-Mobile; +http://www.google.com/mobile/adsbot.html)'
    expected:
      DeviceClass                          : 'Robot Mobile'
      DeviceName                           : 'Google'
      DeviceBrand                          : 'Google'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Google'
      OperatingSystemVersion               : 'Google'
      OperatingSystemNameVersion           : 'Google'
      LayoutEngineClass                    : 'Robot'
      LayoutEngineName                     : 'Googlebot'
      LayoutEngineVersion                  : 'Googlebot'
      LayoutEngineVersionMajor             : 'Googlebot'
      LayoutEngineNameVersion              : 'Googlebot'
      LayoutEngineNameVersionMajor         : 'Googlebot'
      AgentClass                           : 'Robot'
      AgentName                            : 'Googlebot'
      AgentVersion                         : 'AdsBot-Google-Mobile'
      AgentVersionMajor                    : 'AdsBot'
      AgentNameVersion                     : 'Googlebot AdsBot-Google-Mobile'
      AgentNameVersionMajor                : 'Googlebot AdsBot'
      AgentInformationUrl                  : 'http://www.google.com/mobile/adsbot.html'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPhone; CPU iPhone OS 9_1 like Mac OS X) AppleWebKit/601.1.46 (KHTML, like Gecko) Version/9.0 Mobile/13B143 Safari/601.1 (compatible; AdsBot-Google-Mobile; +http://www.google.com/mobile/adsbot.html)'
    expected:
      DeviceClass                          : 'Robot Mobile'
      DeviceName                           : 'Google'
      DeviceBrand                          : 'Google'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Google'
      OperatingSystemVersion               : 'Google'
      OperatingSystemNameVersion           : 'Google'
      LayoutEngineClass                    : 'Robot'
      LayoutEngineName                     : 'Googlebot'
      LayoutEngineVersion                  : 'Googlebot'
      LayoutEngineVersionMajor             : 'Googlebot'
      LayoutEngineNameVersion              : 'Googlebot'
      LayoutEngineNameVersionMajor         : 'Googlebot'
      AgentClass                           : 'Robot'
      AgentName                            : 'Googlebot'
      AgentVersion                         : 'AdsBot-Google-Mobile'
      AgentVersionMajor                    : 'AdsBot'
      AgentNameVersion                     : 'Googlebot AdsBot-Google-Mobile'
      AgentNameVersionMajor                : 'Googlebot AdsBot'
      AgentInformationUrl                  : 'http://www.google.com/mobile/adsbot.html'


# Google developer testing tool
- matcher:
    require:
    - 'agent.(1)product.(1)comments.entry~"testing"'
    extract:
    - 'AgentClass                          :   1000 :"Testclient"'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (compatible; Google-Structured-Data-Testing-Tool +http://developers.google.com/structured-data/testing-tool/)'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'Google Robot'
      DeviceBrand                          : 'Google'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : '??'
      OperatingSystemNameVersion           : 'Cloud ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Mozilla'
      LayoutEngineVersion                  : '5.0'
      LayoutEngineVersionMajor             : '5'
      LayoutEngineNameVersion              : 'Mozilla 5.0'
      LayoutEngineNameVersionMajor         : 'Mozilla 5'
      AgentClass                           : 'Testclient'
      AgentName                            : 'Google-Structured-Data-Testing-Tool'
      AgentVersion                         : 'http://developers.google.com/structured-data/testing-tool/'
      AgentVersionMajor                    : 'http://developers.google.com/structured-data/testing-tool/'
      AgentNameVersion                     : 'Google-Structured-Data-Testing-Tool http://developers.google.com/structured-data/testing-tool/'
      AgentNameVersionMajor                : 'Google-Structured-Data-Testing-Tool http://developers.google.com/structured-data/testing-tool/'
      AgentInformationUrl                  : 'http://developers.google.com/structured-data/testing-tool/'

- matcher:
    extract:
    - 'DeviceClass                         :    115 :"Robot"'
    - 'DeviceName                          :    115 :"Google Search Appliance"'
    - 'DeviceBrand                         :    115 :"Google"'
    - 'AgentClass                          :    115 :"Robot"'
    - 'AgentName                           :    115 :"Google Search Appliance"'
    - 'GSAInstallationID                   :    115 :agent.(1)product.(1)comments.(2)entry.(1)text[-1]="GID"@'

- test:
    input:
      user_agent_string: 'gsa-crawler (Enterprise; GID-01422; jplastiras@google.com)'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'Google Search Appliance'
      DeviceBrand                          : 'Google'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : '??'
      OperatingSystemNameVersion           : 'Cloud ??'
      LayoutEngineClass                    : 'Robot'
      LayoutEngineName                     : 'gsa-crawler'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'gsa-crawler ??'
      LayoutEngineNameVersionMajor         : 'gsa-crawler ??'
      AgentClass                           : 'Robot'
      AgentName                            : 'Google Search Appliance'
      AgentVersion                         : '??'
      AgentVersionMajor                    : '??'
      AgentNameVersion                     : 'Google Search Appliance ??'
      AgentNameVersionMajor                : 'Google Search Appliance ??'
      AgentInformationEmail                : 'jplastiras@google.com'
      GSAInstallationID                    : 'GID-01422'

- matcher:
    require:
    - 'agent.product.(1)name="AppEngine-Google"'
    - 'agent.product.(1)comments.(1)entry.(1)url="http://code.google.com/appengine"'
    - 'agent.product.(1)comments.(2)entry.(1)keyvalue.(1)key="appid"'
    extract:
    - 'DeviceClass                         :   4000 :"Robot"'
    - 'DeviceName                          :   4000 :"Google AppEngine"'
    - 'DeviceBrand                         :   4000 :"Google"'
    - 'OperatingSystemClass                :   4000 : "Cloud"'
    - 'OperatingSystemName                 :   4000 : "Google Cloud"'
    - 'OperatingSystemVersion              :   4000 : "??"'
    - 'LayoutEngineClass                   :   4000 : "Cloud"'
    - 'LayoutEngineName                    :   4000 : "Cloud"'
    - 'LayoutEngineVersion                 :   4000 : "??"'
    - 'AgentClass                          :   4000 :"Robot"'
    - 'AgentName                           :   4000 :agent.product.(1)comments.(2)entry.(1)keyvalue.(1)version[1]="s"@[2-]'
    - 'AgentVersion                        :   4000 :"??"'

- matcher:
    require:
    - 'agent.product.(1)name="AppEngine-Google"'
    - 'agent.product.(1)comments.(1)entry.(1)url="http://code.google.com/appengine"'
    - 'agent.product.(1)comments.(2)entry.(1)keyvalue.(1)key="appid"'
    extract:
    - 'DeviceClass                         :   4000 :"Robot"'
    - 'DeviceName                          :   4000 :"Google AppEngine"'
    - 'DeviceBrand                         :   4000 :"Google"'
    - 'OperatingSystemClass                :   4000 : "Cloud"'
    - 'OperatingSystemName                 :   4000 : "Google Cloud"'
    - 'OperatingSystemVersion              :   4000 : "??"'
    - 'LayoutEngineClass                   :   4000 : "Cloud"'
    - 'LayoutEngineName                    :   4000 : "Cloud"'
    - 'LayoutEngineVersion                 :   4000 : "??"'
    - 'AgentClass                          :   4000 :"Robot"'
    - 'AgentName                           :   4000 :agent.product.(1)comments.(2)entry.(1)keyvalue.(2)text[1]="s"@[2-]'
    - 'AgentVersion                        :   4000 :"??"'

- matcher:
    require:
    - 'agent.(1)product.(1)name~"bot"'
    - 'agent.(1)product.(1)name~"Google"'
    extract:
    - 'DeviceBrand                         :    200 :"Google"'
    - 'OperatingSystemClass                :    200 : "Cloud"'
    - 'OperatingSystemName                 :    200 : "Google Cloud"'
    - 'OperatingSystemVersion              :    200 : "??"'

#Google AppEngine apps
- test:
    input:
      user_agent_string: 'AppEngine-Google; (+http://code.google.com/appengine; appid: s~king4proxy)'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'Google Appengine'
      DeviceBrand                          : 'Google'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Google Cloud'
      OperatingSystemVersion               : '??'
      OperatingSystemNameVersion           : 'Google Cloud ??'
      LayoutEngineClass                    : 'Cloud'
      LayoutEngineName                     : 'Cloud'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Cloud ??'
      LayoutEngineNameVersionMajor         : 'Cloud ??'
      AgentClass                           : 'Robot'
      AgentName                            : 'king4proxy'
      AgentVersion                         : '??'
      AgentVersionMajor                    : '??'
      AgentNameVersion                     : 'king4proxy ??'
      AgentNameVersionMajor                : 'king4proxy ??'
      AgentInformationUrl                  : 'http://code.google.com/appengine'

- test:
    input:
      user_agent_string: 'AppEngine-Google; (+http://code.google.com/appengine; appid: s~linkqualityaag)'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'Google Appengine'
      DeviceBrand                          : 'Google'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Google Cloud'
      OperatingSystemVersion               : '??'
      OperatingSystemNameVersion           : 'Google Cloud ??'
      LayoutEngineClass                    : 'Cloud'
      LayoutEngineName                     : 'Cloud'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Cloud ??'
      LayoutEngineNameVersionMajor         : 'Cloud ??'
      AgentClass                           : 'Robot'
      AgentName                            : 'linkqualityaag'
      AgentVersion                         : '??'
      AgentVersionMajor                    : '??'
      AgentNameVersion                     : 'linkqualityaag ??'
      AgentNameVersionMajor                : 'linkqualityaag ??'
      AgentInformationUrl                  : 'http://code.google.com/appengine'

#AppEngine-Google; (+http://code.google.com/appengine; appid: s~loa10167767606076078)
#AppEngine-Google; (+http://code.google.com/appengine; appid: s~magicscrollreader234)
#AppEngine-Google; (+http://code.google.com/appengine; appid: s~misterhac)

# Google shopping quality checks

- matcher:
    require:
    - 'agent.product.(1)comments.entry.(1)product.name="Google-Shopping-Quality"'
    - 'agent.product.name="Mobile"'
    extract:
    - 'DeviceClass                         :  10000 :"Robot Mobile"'
    - 'DeviceName                          :  10000 :"Google"'
    - 'DeviceBrand                         :  10000 :"Google"'
    - 'DeviceVersion                       :  10000 :"Google-Shopping-Quality"'
    - 'DeviceFirmwareVersion               :  10000 :"Google"'
    - 'OperatingSystemClass                :  10000 :"Cloud"'
    - 'OperatingSystemName                 :  10000 :"Google Cloud"'
    - 'OperatingSystemVersion              :  10000 :"??"'
    - 'LayoutEngineClass                   :  10000 :"Robot"'
    - 'LayoutEngineName                    :  10000 :"Googlebot"'
    - 'LayoutEngineVersion                 :  10000 :"Googlebot"'
    - 'AgentClass                          :  10000 :"Robot Mobile"'
    - 'AgentName                           :  10000 :"Google-Shopping-Quality"'
    - 'AgentVersion                        :  10000 :"??"'

- matcher:
    require:
    - 'agent.product.(1)comments.entry.(1)product.name="Google-Shopping-Quality"'
    - 'IsNull[agent.product.name="Mobile"]'
    extract:
    - 'DeviceClass                         :  10000 :"Robot"'
    - 'DeviceName                          :  10000 :"Google"'
    - 'DeviceBrand                         :  10000 :"Google"'
    - 'DeviceVersion                       :  10000 :"Google-Shopping-Quality"'
    - 'DeviceFirmwareVersion               :  10000 :"Google"'
    - 'OperatingSystemClass                :  10000 :"Cloud"'
    - 'OperatingSystemName                 :  10000 :"Google Cloud"'
    - 'OperatingSystemVersion              :  10000 :"??"'
    - 'LayoutEngineClass                   :  10000 :"Robot"'
    - 'LayoutEngineName                    :  10000 :"Googlebot"'
    - 'LayoutEngineVersion                 :  10000 :"Googlebot"'
    - 'AgentClass                          :  10000 :"Robot"'
    - 'AgentName                           :  10000 :"Google-Shopping-Quality"'
    - 'AgentVersion                        :  10000 :"??"'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPhone; CPU iPhone OS 6_0 like Mac OS X) AppleWebKit/536.26 (KHTML, like Gecko) Version/6.0 Mobile/10A5376e Safari/8536.25 (compatible; Google-Shopping-Quality +http://www.google.com/merchants/tos/extend/BE/tos.html)'
    expected:
      DeviceClass                          : 'Robot Mobile'
      DeviceName                           : 'Google'
      DeviceBrand                          : 'Google'
      DeviceVersion                        : 'Google-Shopping-Quality'
      DeviceFirmwareVersion                : 'Google'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Google Cloud'
      OperatingSystemVersion               : '??'
      OperatingSystemNameVersion           : 'Google Cloud ??'
      LayoutEngineClass                    : 'Robot'
      LayoutEngineName                     : 'Googlebot'
      LayoutEngineVersion                  : 'Googlebot'
      LayoutEngineVersionMajor             : 'Googlebot'
      LayoutEngineNameVersion              : 'Googlebot'
      LayoutEngineNameVersionMajor         : 'Googlebot'
      AgentClass                           : 'Robot Mobile'
      AgentName                            : 'Google-Shopping-Quality'
      AgentVersion                         : '??'
      AgentVersionMajor                    : '??'
      AgentNameVersion                     : 'Google-Shopping-Quality ??'
      AgentNameVersionMajor                : 'Google-Shopping-Quality ??'
      AgentInformationUrl                  : 'http://www.google.com/merchants/tos/extend/BE/tos.html'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 AppleWebKit/537.36 (KHTML, like Gecko) Chrome/27.0.1453 Safari/537.36 (compatible; Google-Shopping-Quality +http://www.google.com/merchants/tos/extend/NL/tos.html)'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'Google'
      DeviceBrand                          : 'Google'
      DeviceFirmwareVersion                : 'Google'
      DeviceVersion                        : 'Google-Shopping-Quality'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Google Cloud'
      OperatingSystemVersion               : '??'
      OperatingSystemNameVersion           : 'Google Cloud ??'
      LayoutEngineClass                    : 'Robot'
      LayoutEngineName                     : 'Googlebot'
      LayoutEngineVersion                  : 'Googlebot'
      LayoutEngineVersionMajor             : 'Googlebot'
      LayoutEngineNameVersion              : 'Googlebot'
      LayoutEngineNameVersionMajor         : 'Googlebot'
      AgentClass                           : 'Robot'
      AgentName                            : 'Google-Shopping-Quality'
      AgentVersion                         : '??'
      AgentVersionMajor                    : '??'
      AgentNameVersion                     : 'Google-Shopping-Quality ??'
      AgentNameVersionMajor                : 'Google-Shopping-Quality ??'
      AgentInformationUrl                  : 'http://www.google.com/merchants/tos/extend/NL/tos.html'

#TODO: gfe means the Google Front End
#Mozilla/5.0 (Windows NT 6.1; WOW64; rv:43.0) Gecko/20100101 Firefox/43.0,gzip(gfe) (via shopping.google.com)
# https://support.google.com/webmasters/answer/1061943?hl=en
# http://stackoverflow.com/questions/2862874/what-is-gzipgfe

- test:
    input:
      user_agent_string: 'AdsBot-Google-Mobile-Apps (compatible; Mediapartners-Google/2.1;+http://www.google.com/bot.html)'
    expected:
      DeviceClass                          : 'Robot Mobile'
      DeviceName                           : 'Google Adsbot-Google-Mobile-Apps'
      DeviceBrand                          : 'Google'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Google Cloud'
      OperatingSystemVersion               : '??'
      OperatingSystemNameVersion           : 'Google Cloud ??'
      LayoutEngineClass                    : 'Robot'
      LayoutEngineName                     : 'AdsBot-Google-Mobile-Apps'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'AdsBot-Google-Mobile-Apps ??'
      LayoutEngineNameVersionMajor         : 'AdsBot-Google-Mobile-Apps ??'
      AgentClass                           : 'Robot'
      AgentName                            : 'AdsBot-Google-Mobile-Apps'
      AgentVersion                         : '??'
      AgentVersionMajor                    : '??'
      AgentNameVersion                     : 'AdsBot-Google-Mobile-Apps ??'
      AgentNameVersionMajor                : 'AdsBot-Google-Mobile-Apps ??'
      AgentInformationUrl                  : 'http://www.google.com/bot.html'


# https://developers.google.com/speed/docs/insights/faq#whyonlinediff
- matcher:
    require:
    - 'agent.product.(1)comments.entry="Google Page Speed Insights"'
    extract:
    - '__Set_ALL_Fields__                  :   9999 :"<<<null>>>"' # Must be 1 lower than the rest (or you will wipe yourself too)
    - 'DeviceClass                         :  10000 :"Robot"'
    - 'DeviceName                          :  10000 :"Google"'
    - 'DeviceBrand                         :  10000 :"Google"'
    - 'DeviceVersion                       :  10000 :"Google Page Speed Insights"'
    - 'DeviceFirmwareVersion               :  10000 :"Google"'
    - 'OperatingSystemClass                :  10000 :"Cloud"'
    - 'OperatingSystemName                 :  10000 :"Google Cloud"'
    - 'OperatingSystemVersion              :  10000 :"??"'
    - 'OperatingSystemNameVersion          :  10000 :"Google Cloud ??"'
    - 'LayoutEngineClass                   :  10000 :"Robot"'
    - 'LayoutEngineName                    :  10000 :"Google Page Speed Insights"'
    - 'LayoutEngineVersion                 :  10000 :"??"'
    - 'AgentClass                          :  10000 :"Robot"'
    - 'AgentName                           :  10000 :"Google Page Speed Insights"'
    - 'AgentVersion                        :  10000 :"??"'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko; Google Page Speed Insights) Chrome/27.0.1453 Safari/537.36'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'Google'
      DeviceBrand                          : 'Google'
      DeviceFirmwareVersion                : 'Google'
      DeviceVersion                        : 'Google Page Speed Insights'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Google Cloud'
      OperatingSystemVersion               : '??'
      OperatingSystemNameVersion           : 'Google Cloud ??'
      LayoutEngineClass                    : 'Robot'
      LayoutEngineName                     : 'Google Page Speed Insights'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Google Page Speed Insights ??'
      LayoutEngineNameVersionMajor         : 'Google Page Speed Insights ??'
      AgentClass                           : 'Robot'
      AgentName                            : 'Google Page Speed Insights'
      AgentVersion                         : '??'
      AgentVersionMajor                    : '??'
      AgentNameVersion                     : 'Google Page Speed Insights ??'
      AgentNameVersionMajor                : 'Google Page Speed Insights ??'

# https://support.google.com/webmasters/answer/1062498?hl=en

- matcher:
    require:
    - 'agent.product.(1)comments.entry[1-2]="Google Web"'
    extract:
    - '__Set_ALL_Fields__                  :   9999 :"<<<null>>>"' # Must be 1 lower than the rest (or you will wipe yourself too)
    - 'DeviceClass                         :  10000 :"Robot"'
    - 'DeviceName                          :  10000 :"Google"'
    - 'DeviceBrand                         :  10000 :"Google"'
    - 'DeviceVersion                       :  10000 :agent.product.(1)comments.entry[1-3]="Google Web Preview"@'
    - 'DeviceFirmwareVersion               :  10000 :"Google"'
    - 'OperatingSystemClass                :  10000 :"Cloud"'
    - 'OperatingSystemName                 :  10000 :"Google"'
    - 'OperatingSystemVersion              :  10000 :"Google"'
    - 'LayoutEngineClass                   :  10000 :"Robot"'
    - 'LayoutEngineName                    :  10000 :agent.product.(1)comments.entry[1-3]="Google Web Preview"@'
    - 'LayoutEngineVersion                 :  10000 :"??"'
    - 'AgentClass                          :  10000 :"Robot"'
    - 'AgentName                           :  10000 :agent.product.(1)comments.entry[1-3]="Google Web Preview"@'
    - 'AgentVersion                        :  10000 :"??"'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko; Google Web Preview) Chrome/27.0.1453 Safari/537.36'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'Google'
      DeviceBrand                          : 'Google'
      DeviceFirmwareVersion                : 'Google'
      DeviceVersion                        : 'Google Web Preview'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Google'
      OperatingSystemVersion               : 'Google'
      OperatingSystemNameVersion           : 'Google'
      LayoutEngineClass                    : 'Robot'
      LayoutEngineName                     : 'Google Web Preview'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Google Web Preview ??'
      LayoutEngineNameVersionMajor         : 'Google Web Preview ??'
      AgentClass                           : 'Robot'
      AgentName                            : 'Google Web Preview'
      AgentVersion                         : '??'
      AgentVersionMajor                    : '??'
      AgentNameVersion                     : 'Google Web Preview ??'
      AgentNameVersionMajor                : 'Google Web Preview ??'



- test:
    input:
      user_agent_string: 'Mozilla/5.0 AppleWebKit/537.36 (KHTML, like Gecko; Google Web Preview Analytics) Chrome/27.0.1453 Safari/537.36 (compatible; Googlebot/2.1; +http://www.google.com/bot.html)'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'Google'
      DeviceBrand                          : 'Google'
      DeviceFirmwareVersion                : 'Google'
      DeviceVersion                        : 'Google Web Preview Analytics'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Google'
      OperatingSystemVersion               : 'Google'
      OperatingSystemNameVersion           : 'Google'
      LayoutEngineClass                    : 'Robot'
      LayoutEngineName                     : 'Google Web Preview Analytics'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Google Web Preview Analytics ??'
      LayoutEngineNameVersionMajor         : 'Google Web Preview Analytics ??'
      AgentClass                           : 'Robot'
      AgentName                            : 'Google Web Preview Analytics'
      AgentVersion                         : '??'
      AgentVersionMajor                    : '??'
      AgentNameVersion                     : 'Google Web Preview Analytics ??'
      AgentNameVersionMajor                : 'Google Web Preview Analytics ??'



# Google developer testing tool
- matcher:
    require:
    - 'agent.(1)product.(1)comments.entry="Google-Test"'
    extract:
    - 'DeviceClass                         :   1000 :"Robot"'
    - 'DeviceName                          :   1000 :"Robot"'
    - 'DeviceBrand                         :   1000 :"Google"'
    - 'OperatingSystemClass                :   1000 :"Cloud"'
    - 'OperatingSystemName                 :   1000 :"Cloud"'
    - 'OperatingSystemVersion              :   1000 :"??"'
    - 'LayoutEngineClass                   :   1000 :"Robot"'
    - 'LayoutEngineName                    :   1000 :"Google-Test"'
    - 'LayoutEngineVersion                 :   1000 :"??"'
    - 'AgentClass                          :   1000 :"Testclient"'
    - 'AgentName                           :   1000 :"Google-Test"'
    - 'AgentVersion                        :   1000 :"??"'


- test: # TODO: Figure out what kind of useragent this really is.
    input:
      user_agent_string: 'Mozilla/5.0 (compatible; Google-Test;)'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'Google Robot'
      DeviceBrand                          : 'Google'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : '??'
      OperatingSystemNameVersion           : 'Cloud ??'
      LayoutEngineClass                    : 'Robot'
      LayoutEngineName                     : 'Google-Test'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Google-Test ??'
      LayoutEngineNameVersionMajor         : 'Google-Test ??'
      AgentClass                           : 'Testclient'
      AgentName                            : 'Google-Test'
      AgentVersion                         : '??'
      AgentVersionMajor                    : '??'
      AgentNameVersion                     : 'Google-Test ??'
      AgentNameVersionMajor                : 'Google-Test ??'


#- test: # TODO: Figure out how to classify this one
#    input:
#      user_agent_string: 'Mozilla/5.0 (compatible) Feedfetcher-Google; (+http://www.google.com/feedfetcher.html)'
#    expected:
#      DeviceClass                          : 'Robot'
#      DeviceName                           : 'Google Appengine'
#      DeviceBrand                          : 'Google'
#      OperatingSystemClass                 : 'Cloud'
#      OperatingSystemName                  : 'Cloud'
#      OperatingSystemVersion               : '??'
#      OperatingSystemNameVersion           : 'Cloud ??'
#      LayoutEngineClass                    : 'Unknown'
#      LayoutEngineName                     : 'Unknown'
#      LayoutEngineVersion                  : '??'
#      LayoutEngineVersionMajor             : '??'
#      AgentClass                           : 'Cloud Application'
#      AgentName                            : 'Feedfetcher'
#      AgentVersion                         : '??'
#      AgentVersionMajor                    : '??'
#      AgentNameVersion                     : 'Feedfetcher ??'
#      AgentNameVersionMajor                : 'Feedfetcher ??'
#      AgentInformationUrl                  : 'http://www.google.com/feedfetcher.html'
